ktor {
    deployment {
        port = 8080
        port = ${?PORT}
        host = "0.0.0.0"
        host = ${?HOSTNAME}
    }
    application {
        modules = []
    }
}

oauth {
    dataPath = ${user.home}"/.ktor-oauth"
    server {
        # Route prefix for all OAuth endpoints (default: "/.oauth")
        routePrefix = "/.oauth"

        # Token expiration (HOCON format: 90d, 2160h, etc.)
        tokenExpiration = 90d

        # Auth code storage: "memory" or fully qualified class name
        authCodeStorage = "memory"

        jwt {
            issuer = "ktor-oauth"
            secretFile = ${oauth.dataPath}"/jwt.secret"
        }

        endpoints {
            register = "/register"
            authorize = "/authorize"
            token = "/token"
            provision = "/provision"
        }
    }

    sessions {
        # Session storage: "directory", "encrypted", or fully qualified class name
        storage = "directory"
        dataPath = ${oauth.dataPath}"/sessions"

        # Session TTL (HOCON format: 90d, 2160h, etc.)
        ttl = 90d

        cleanup {
            enabled = true
            interval = 1h
            initialDelay = 5m
        }
    }
}
